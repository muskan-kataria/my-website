<html>
    
     <script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.3.1.js"></script>

        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css"/>
         
        <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
    
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">


<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
     <style>
         
         .tick{
             height:25px;
             width: :25px;
             background-color: greenyellow;
         }
         
            .cross{
             height:25px;
             width: :25px;
             background-color:red;
         }
         
         #h{
             background-color: aqua;
             height:50px;
                 width:100%;
         }
         
     
        

#head
{
    font-weight: bold;
    background-color: darkblue;
    color: white;
    box-shadow: 0 0 10px;
    width:100%;
     justify-content: center;
    align-items: center;
}
           .main
           {
               width:80%;
               border-color: black;
               height:20px;
                height: 85vh;
               box-shadow: 0 0 15px;
               justify-content: center;
               align-content: center;
                   align-items: center;
    display: flex;
margin-top: 15px;
}
        .textbox
           {
              margin :10px;  
           }
           .head
           {
               background-color: lightgray;
               width:100%;
               text-align: center;
               height:30px;
               font-size: 25px;
               width:500px;
           }
           .content
           {
               background-color: white;
               width:100%;
               text-align: center;
               height:30px;
               font-size: 25px;
               width:500px;
           }
           #boxes
           {
               width:1000px;
           }
           #image
           {
               width:30px;
               height:30px;
           }
           img
           {
               border-color: black;
           }

        </style>

<head>
    
  <title> CodeStuff</title>  
    
    
    </head>
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">   
    
    
    <body>
        {{>userheader}}
    
    <div>
        
        
        
        
        
        
        </div>
    
        
        <div>
    <center>
            <form >
                <h1>Create Communities</h1><br>
         Name:        <input id="name"/><br>
         Description: <input id="desc"/><br>
         Rule:         <select id="rule">
            
            <option value="Direct">Direct</option>
 <option value="Permission">Permission</option>
            
            </select><br>
                  <input type="submit" id="create" onclick="abc()" value="Create Community"/>
            </form>
            
            </center>
        
        </div>
    
     
    
    
    
    </body>

<script>
    
    
      var    btn=document.createElement("button");
                     btn.setAttribute("id","btn");
                        btn.innerHTML="CodeStuff";
                     document.getElementById("user").appendChild(btn);
    
    
    
    
    
    function abc(){
        


var d = new Date();

var month = d.getMonth()+1;
var day = d.getDate();

var output = (day<10 ? '0' : '') + day+ '-' +
    (month<10 ? '0' : '') + month + '-' +
    d.getFullYear() ;
        
        console.log(output);
     
        console.log("click");
        
        var obj=new Object();
        obj.Name=document.getElementById("name").value;
        obj.Desc=document.getElementById("desc").value;
        obj.rule=document.getElementById("rule").value;
        obj.date=output;
        console.log(obj.rule);
        obj.status="DEACTIVE";
        
        console.log(obj);
        
  
         
         
        
        
        
        
        var obj2=new Object();
        obj2.Name=document.getElementById("name").value;
        
        if(obj2.Name=='')
           { alert("name cant left empty");
           }
        else
            {
        
        var xhttp=new XMLHttpRequest();
        
       xhttp.open("POST",'/create');
                     xhttp.setRequestHeader("content-type","application/json");
                                    xhttp.send(JSON.stringify(obj));
                                     xhttp.onreadystatechange=function()
            {
                                           // console.log("click");
                 if (this.readyState == 4 && this.status == 200) {
                    if(this.responseText=="Created"){
                        
                   
                    alert("created successfully");
                        //location.replace('communities.html');
                    
            
                    }
                     
                     else
                         alert("error");
                 
                                     
      // var mxhttp
       xhttp=new XMLHttpRequest();
            xhttp.open("POST",'/cmember');
                     xhttp.setRequestHeader("content-type","application/json");
                                    xhttp.send(JSON.stringify(obj2));
                                     xhttp.onreadystatechange=function()
            {
                                           console.log("click");
                 if (this.readyState == 4 && this.status == 200) {
                    if(this.responseText=="updated"){   
                        alert("member created");
                    
                       // location.replace('communities.html');
                           
    }
     
                     
                     
                     var comm;
                     var id;
                     
                     xhttp=new XMLHttpRequest();
            xhttp.open("POST",'/myrequests');
                     xhttp.setRequestHeader("content-type","application/json");
                                    xhttp.send(JSON.stringify(obj2));
                                     xhttp.onreadystatechange=function()
            {
                                           console.log("click");
                 if (this.readyState == 4 && this.status == 200) {
                     comm=JSON.parse(this.responseText);
                     id=comm._id;
                     
                 }
                                         
                                         console.log(id);
                                         
                                         var obj3=new Object();
                                         obj3.id=id;
                                         
                                      var    bxhttp=new XMLHttpRequest();
            bxhttp.open("POST",'/ucomm');
                     bxhttp.setRequestHeader("content-type","application/json");
                                    bxhttp.send(JSON.stringify(obj3));
                                     bxhttp.onreadystatechange=function()
            {
                                         //  console.log("click");
                 if (this.readyState == 4 && this.status == 200) {
                     if(this.responseText=="updated");
                     window.location.href=('/communities');
                     
                 }
                                         
                                         
                                     }
                                         
                                         
                                         
                                         
                                     }
                     
                     
                     
                     
                                     
    }
 
    
                                     }
                 }
                                     }
    }
                                     }
    
    
    
    
    
    </script>




</html>